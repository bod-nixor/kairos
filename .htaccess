Options -Indexes -MultiViews
RewriteEngine On
RewriteBase /signoff/

# If someone hits /signoff/public/... force clean URL without /public
RewriteCond %{THE_REQUEST} \s/+signoff/public/ [NC]
RewriteRule ^public/(.*)$ $1 [R=301,L]

# API: map /signoff/api/* -> /signoff/public/api/*
RewriteRule ^api/(.*)$ public/api/$1 [L]

# Pretty pages (no .html in location bar)
# Map known slugs to actual files under /public
RewriteRule ^$ public/index.html [L]
RewriteRule ^ta/?$ public/ta.html [L]
RewriteRule ^manager/?$ public/manager.html [L]
RewriteRule ^admin/?$ public/admin.html [L]
RewriteRule ^room/?$ public/room.html [L]

# Fallback: if not a real file/dir, serve from /public (assets, SPA links)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ public/$1 [L]

# Security headers already present elsewhere; do NOT reintroduce COOP/COEP that break Google Identity
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set Referrer-Policy "no-referrer-when-downgrade"
  Header always set Cross-Origin-Opener-Policy "same-origin-allow-popups"
  Header always unset Cross-Origin-Embedder-Policy
  Header always unset Cross-Origin-Resource-Policy
</IfModule>
